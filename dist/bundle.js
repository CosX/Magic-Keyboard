(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

var width = window.innerWidth;
var height = window.innerHeight;
var frameRate = 1 / 40;
var canvas = "";
var ctx = "";

var randomstartplacement = false;
var rainbowmode = true;
var letterpushed = false;
var letterlist = [];

var Cd = 0.47;
var rho = 1.22;
var A = Math.PI * 15 * 15 / 10000;
var ag = 9.81;

var setup = function setup() {
  canvas = document.getElementsByTagName("canvas")[0];
  ctx = canvas.getContext("2d");
  canvas.width = width;
  canvas.height = height;
  window.addEventListener('resize', resizeCanvas, false);
  window.addEventListener('keydown', keyUp, false);

  document.getElementById('rainbow').onclick = function (e) {
    rainbowmode = e.currentTarget.checked;
  };

  document.getElementById('startplacement').onclick = function (e) {
    randomstartplacement = e.currentTarget.checked;
  };

  ctx.shadowBlur = 50;

  initSentence("HELLO PEOPLE! TYPE SOMETHING!");
  loop();
};

var resizeCanvas = function resizeCanvas() {
  width = window.innerWidth;
  height = window.innerHeight;
  canvas.width = width;
  canvas.height = height;
};

var keyUp = function keyUp(e) {
  letterpushed = true;
  var ltr = generateLetter(String.fromCharCode(e.keyCode));
  letterlist.push(ltr);
};

var initSentence = function initSentence(s) {
  var sentence = s.split('');
  var i = 0;
  letterpushed = false;
  setInterval(function () {
    if (sentence.length >= i + 1 && !letterpushed) {
      var ltr = generateLetter(sentence[i]);
      letterlist.push(ltr);
      i++;
    }
  }, 300);
};

var generateLetter = function generateLetter(value) {
  return {
    position: {
      x: generateStartPlacement(),
      y: height
    },
    velocity: {
      x: getRandomArbitrary(-5, 5),
      y: getRandomArbitrary(-15, -60)
    },
    mass: 0.1,
    radius: 40,
    restitution: -1,
    value: value,
    duration: 400,
    color: generateColor(),
    draw: function draw(context, l) {
      context.save();
      context.font = "80px monospace";
      context.shadowColor = l.color;
      context.fillStyle = l.color;
      context.fillText(l.value, l.position.x, l.position.y);
      context.restore();
    }
  };
};

var generateColor = function generateColor() {
  if (rainbowmode) {
    return "#" + Math.random().toString(16).slice(2, 8);
  }
  return "#ffffff";
};

var generateStartPlacement = function generateStartPlacement() {
  if (randomstartplacement) {
    return getRandomArbitrary(0, width);
  }
  return width / 2;
};

var loop = function loop() {
  ctx.clearRect(0, 0, width, height);
  letterlist.map(function (ltr) {
    var Fx = -0.5 * Cd * A * rho * ltr.velocity.x * ltr.velocity.x * ltr.velocity.x / Math.abs(ltr.velocity.x);
    var Fy = -0.5 * Cd * A * rho * ltr.velocity.y * ltr.velocity.y * ltr.velocity.y / Math.abs(ltr.velocity.y);

    Fx = isNaN(Fx) ? 0 : Fx;
    Fy = isNaN(Fy) ? 0 : Fy;

    var ax = Fx / ltr.mass;
    var ay = ag + Fy / ltr.mass;

    ltr.velocity.x += ax * frameRate;
    ltr.velocity.y += ay * frameRate;

    ltr.position.x += ltr.velocity.x * frameRate * 100;
    ltr.position.y += ltr.velocity.y * frameRate * 100;

    if (ltr.position.y > height - ltr.radius) {
      ltr.velocity.y *= ltr.restitution;
      ltr.position.y = height - ltr.radius;
    }

    if (ltr.position.x > width - ltr.radius) {
      ltr.velocity.x *= ltr.restitution;
      ltr.position.x = width - ltr.radius;
    }

    if (ltr.position.x < ltr.radius) {
      ltr.velocity.x *= ltr.restitution;
      ltr.position.x = ltr.radius;
    }

    ltr.draw(ctx, ltr);
    ltr.duration--;
  });

  letterlist = letterlist.filter(function (ltr) {
    return ltr.duration > 0;
  });

  window.requestAnimationFrame(function () {
    loop();
  });
};

var getRandomArbitrary = function getRandomArbitrary(min, max) {
  return Math.random() * (max - min) + min;
};

setup();

},{}]},{},[1])


//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJpbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUEsSUFBSSxRQUFRLE9BQU8sVUFBUDtBQUNaLElBQUksU0FBUyxPQUFPLFdBQVA7QUFDYixJQUFJLFlBQVksSUFBRSxFQUFGO0FBQ2hCLElBQUksU0FBUyxFQUFUO0FBQ0osSUFBSSxNQUFNLEVBQU47O0FBRUosSUFBSSx1QkFBdUIsS0FBdkI7QUFDSixJQUFJLGNBQWMsSUFBZDtBQUNKLElBQUksZUFBZSxLQUFmO0FBQ0osSUFBSSxhQUFhLEVBQWI7O0FBRUosSUFBTSxLQUFLLElBQUw7QUFDTixJQUFNLE1BQU0sSUFBTjtBQUNOLElBQU0sSUFBSSxLQUFLLEVBQUwsR0FBVSxFQUFWLEdBQWUsRUFBZixHQUFxQixLQUFyQjtBQUNWLElBQU0sS0FBSyxJQUFMOztBQUVOLElBQU0sUUFBUSxTQUFSLEtBQVEsR0FBTTtBQUNsQixXQUFTLFNBQVMsb0JBQVQsQ0FBOEIsUUFBOUIsRUFBd0MsQ0FBeEMsQ0FBVCxDQURrQjtBQUVsQixRQUFNLE9BQU8sVUFBUCxDQUFrQixJQUFsQixDQUFOLENBRmtCO0FBR2xCLFNBQU8sS0FBUCxHQUFlLEtBQWYsQ0FIa0I7QUFJbEIsU0FBTyxNQUFQLEdBQWdCLE1BQWhCLENBSmtCO0FBS2xCLFNBQU8sZ0JBQVAsQ0FBd0IsUUFBeEIsRUFBa0MsWUFBbEMsRUFBZ0QsS0FBaEQsRUFMa0I7QUFNbEIsU0FBTyxnQkFBUCxDQUF3QixTQUF4QixFQUFtQyxLQUFuQyxFQUEwQyxLQUExQyxFQU5rQjs7QUFRbEIsV0FBUyxjQUFULENBQXdCLFNBQXhCLEVBQW1DLE9BQW5DLEdBQTZDLFVBQUMsQ0FBRCxFQUFPO0FBQ2xELGtCQUFjLEVBQUUsYUFBRixDQUFnQixPQUFoQixDQURvQztHQUFQLENBUjNCOztBQVluQixXQUFTLGNBQVQsQ0FBd0Is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bnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJsZXQgd2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcclxubGV0IGhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcclxubGV0IGZyYW1lUmF0ZSA9IDEvNDA7XHJcbmxldCBjYW52YXMgPSBcIlwiO1xyXG5sZXQgY3R4ID0gXCJcIjtcclxuXHJcbmxldCByYW5kb21zdGFydHBsYWNlbWVudCA9IGZhbHNlO1xyXG5sZXQgcmFpbmJvd21vZGUgPSB0cnVlO1xyXG5sZXQgbGV0dGVycHVzaGVkID0gZmFsc2U7XHJcbmxldCBsZXR0ZXJsaXN0ID0gW107XHJcblxyXG5jb25zdCBDZCA9IDAuNDc7XHJcbmNvbnN0IHJobyA9IDEuMjI7XHJcbmNvbnN0IEEgPSBNYXRoLlBJICogMTUgKiAxNSAvICgxMDAwMCk7XHJcbmNvbnN0IGFnID0gOS44MTsgXHJcblxyXG5jb25zdCBzZXR1cCA9ICgpID0+IHtcclxuICBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImNhbnZhc1wiKVswXTtcclxuICBjdHggPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gIGNhbnZhcy53aWR0aCA9IHdpZHRoO1xyXG4gIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHJlc2l6ZUNhbnZhcywgZmFsc2UpO1xyXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywga2V5VXAsIGZhbHNlKTtcclxuICAgIFxyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyYWluYm93Jykub25jbGljayA9IChlKSA9PiB7XHJcbiAgICByYWluYm93bW9kZSA9IGUuY3VycmVudFRhcmdldC5jaGVja2VkO1xyXG4gIH07XHJcblxyXG5cdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFydHBsYWNlbWVudCcpLm9uY2xpY2sgPSAoZSkgPT4ge1xyXG4gICAgcmFuZG9tc3RhcnRwbGFjZW1lbnQgPSBlLmN1cnJlbnRUYXJnZXQuY2hlY2tlZDtcclxuXHR9O1xyXG5cclxuICBjdHguc2hhZG93Qmx1ciA9IDUwOyBcclxuXHJcbiAgaW5pdFNlbnRlbmNlKFwiSEVMTE8gUEVPUExFISBUWVBFIFNPTUVUSElORyFcIik7XHJcbiAgbG9vcCgpO1xyXG59XHJcblxyXG5jb25zdCByZXNpemVDYW52YXMgPSAoKSA9PiB7XHJcbiAgd2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcclxuICBoZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XHJcbiAgY2FudmFzLndpZHRoID0gd2lkdGg7XHJcbiAgY2FudmFzLmhlaWdodCA9IGhlaWdodDtcclxufTtcclxuXHJcbmNvbnN0IGtleVVwID0gKGUpID0+IHtcclxuXHRsZXR0ZXJwdXNoZWQgPSB0cnVlO1xyXG4gIGxldCBsdHIgPSBnZW5lcmF0ZUxldHRlcihTdHJpbmcuZnJvbUNoYXJDb2RlKGUua2V5Q29kZSkpO1xyXG4gIGxldHRlcmxpc3QucHVzaChsdHIpO1xyXG59O1xyXG5cclxuY29uc3QgaW5pdFNlbnRlbmNlID0gKHMpID0+IHtcclxuXHRsZXQgc2VudGVuY2UgPSBzLnNwbGl0KCcnKTtcclxuXHRsZXQgaSA9IDA7XHJcblx0bGV0dGVycHVzaGVkID0gZmFsc2U7XHJcblx0c2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG5cdFx0aWYoc2VudGVuY2UubGVuZ3RoID49IGkrMSAmJiAhbGV0dGVycHVzaGVkKXtcclxuICBcdFx0bGV0IGx0ciA9IGdlbmVyYXRlTGV0dGVyKHNlbnRlbmNlW2ldKTtcclxuICAgICAgbGV0dGVybGlzdC5wdXNoKGx0cik7XHJcbiAgICAgIGkrKztcclxuXHRcdH1cclxuXHR9LCAzMDApO1xyXG59O1xyXG5cclxuY29uc3QgZ2VuZXJhdGVMZXR0ZXIgPSAodmFsdWUpID0+IHtcclxuXHRyZXR1cm4ge1xyXG4gICAgcG9zaXRpb246IHtcclxuICAgICAgeDogZ2VuZXJhdGVTdGFydFBsYWNlbWVudCgpLCBcclxuICAgICAgeTogaGVpZ2h0XHJcbiAgICB9LFxyXG4gICAgdmVsb2NpdHk6IHtcclxuICAgICAgeDogZ2V0UmFuZG9tQXJiaXRyYXJ5KC01LCA1KSwgXHJcbiAgICAgIHk6IGdldFJhbmRvbUFyYml0cmFyeSgtMTUsIC02MClcclxuICAgIH0sXHJcbiAgICBtYXNzOiAwLjEsXHJcbiAgICByYWRpdXM6IDQwLFxyXG4gICAgcmVzdGl0dXRpb246IC0xLFxyXG4gICAgdmFsdWU6IHZhbHVlLFxyXG4gICAgZHVyYXRpb246IDQwMCxcclxuICAgIGNvbG9yOiBnZW5lcmF0ZUNvbG9yKCksXHJcbiAgICBkcmF3KGNvbnRleHQsIGwpe1xyXG4gICAgICBjb250ZXh0LnNhdmUoKTtcclxuICAgICBcdGNvbnRleHQuZm9udD1cIjgwcHggbW9ub3NwYWNlXCI7XHJcbiAgICAgXHRjb250ZXh0LnNoYWRvd0NvbG9yID0gbC5jb2xvcjtcclxuXHRcdCAgY29udGV4dC5maWxsU3R5bGUgPSBsLmNvbG9yO1xyXG4gICAgICBjb250ZXh0LmZpbGxUZXh0KGwudmFsdWUsIGwucG9zaXRpb24ueCwgbC5wb3NpdGlvbi55KTtcclxuICAgICAgY29udGV4dC5yZXN0b3JlKCk7XHJcbiAgICB9XHJcblx0fTtcclxuXHJcbn07XHJcblxyXG5jb25zdCBnZW5lcmF0ZUNvbG9yID0gKCkgPT57XHJcblx0aWYgKHJhaW5ib3dtb2RlKXtcclxuXHRcdHJldHVybiBcIiNcIiArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMTYpLnNsaWNlKDIsIDgpO1xyXG5cdH1cclxuXHRyZXR1cm4gXCIjZmZmZmZmXCI7XHJcbn07XHJcblxyXG5jb25zdCBnZW5lcmF0ZVN0YXJ0UGxhY2VtZW50ID0gKCkgPT57XHJcblx0aWYgKHJhbmRvbXN0YXJ0cGxhY2VtZW50KXtcclxuXHRcdHJldHVybiBnZXRSYW5kb21BcmJpdHJhcnkoMCwgd2lkdGgpO1xyXG5cdH1cclxuXHRyZXR1cm4gd2lkdGggLyAyO1xyXG59O1xyXG5cclxuY29uc3QgbG9vcCA9ICgpID0+IHtcclxuXHRjdHguY2xlYXJSZWN0KDAsMCwgd2lkdGgsIGhlaWdodCk7XHJcbiAgbGV0dGVybGlzdC5tYXAoKGx0cikgPT4ge1xyXG4gICAgbGV0IEZ4ID0gLTAuNSAqIENkICogQSAqIHJobyAqIGx0ci52ZWxvY2l0eS54ICogbHRyLnZlbG9jaXR5LnggKiBsdHIudmVsb2NpdHkueCAvIE1hdGguYWJzKGx0ci52ZWxvY2l0eS54KTtcclxuICAgIGxldCBGeSA9IC0wLjUgKiBDZCAqIEEgKiByaG8gKiBsdHIudmVsb2NpdHkueSAqIGx0ci52ZWxvY2l0eS55ICogbHRyLnZlbG9jaXR5LnkgLyBNYXRoLmFicyhsdHIudmVsb2NpdHkueSk7XHJcbiAgICBcclxuICAgIEZ4ID0gKGlzTmFOKEZ4KSA/IDAgOiBGeCk7XHJcbiAgICBGeSA9IChpc05hTihGeSkgPyAwIDogRnkpO1xyXG4gICAgXHJcbiAgICBsZXQgYXggPSBGeCAvIGx0ci5tYXNzO1xyXG4gICAgbGV0IGF5ID0gYWcgKyAoRnkgLyBsdHIubWFzcyk7XHJcblxyXG4gICAgbHRyLnZlbG9jaXR5LnggKz0gYXgqZnJhbWVSYXRlO1xyXG4gICAgbHRyLnZlbG9jaXR5LnkgKz0gYXkqZnJhbWVSYXRlO1xyXG4gICAgXHJcbiAgICBsdHIucG9zaXRpb24ueCArPSBsdHIudmVsb2NpdHkueCpmcmFtZVJhdGUqMTAwO1xyXG4gICAgbHRyLnBvc2l0aW9uLnkgKz0gbHRyLnZlbG9jaXR5LnkqZnJhbWVSYXRlKjEwMDtcclxuICAgIFxyXG4gICAgaWYgKGx0ci5wb3NpdGlvbi55ID4gaGVpZ2h0IC0gbHRyLnJhZGl1cykge1xyXG4gICAgICBsdHIudmVsb2NpdHkueSAqPSBsdHIucmVzdGl0dXRpb247XHJcbiAgICAgIGx0ci5wb3NpdGlvbi55ID0gaGVpZ2h0IC0gbHRyLnJhZGl1cztcclxuICAgIH1cclxuXHJcbiAgICBpZiAobHRyLnBvc2l0aW9uLnggPiB3aWR0aCAtIGx0ci5yYWRpdXMpIHtcclxuICAgICAgbHRyLnZlbG9jaXR5LnggKj0gbHRyLnJlc3RpdHV0aW9uO1xyXG4gICAgICBsdHIucG9zaXRpb24ueCA9IHdpZHRoIC0gbHRyLnJhZGl1cztcclxuICAgIH1cclxuXHJcbiAgICBpZiAobHRyLnBvc2l0aW9uLnggPCBsdHIucmFkaXVzKSB7XHJcbiAgICAgIGx0ci52ZWxvY2l0eS54ICo9IGx0ci5yZXN0aXR1dGlvbjtcclxuICAgICAgbHRyLnBvc2l0aW9uLnggPSBsdHIucmFkaXVzO1xyXG4gICAgfVxyXG5cclxuXHRcdGx0ci5kcmF3KGN0eCwgbHRyKTtcclxuXHRcdGx0ci5kdXJhdGlvbi0tO1xyXG4gIH0pO1xyXG5cclxuICBsZXR0ZXJsaXN0ID0gbGV0dGVybGlzdC5maWx0ZXIoKGx0cikgPT4ge1xyXG4gIFx0cmV0dXJuIGx0ci5kdXJhdGlvbiA+IDA7XHJcbiAgfSk7XHJcblxyXG4gIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xyXG4gICAgbG9vcCgpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5jb25zdCBnZXRSYW5kb21BcmJpdHJhcnkgPSAobWluLCBtYXgpID0+IHtcclxuICByZXR1cm4gTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4pICsgbWluO1xyXG59XHJcblxyXG5zZXR1cCgpOyJdfQ==
